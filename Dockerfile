FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.version"="0.1.0"
LABEL "com.redhat.apb.spec"=\
"IyMgU2hhcmVkIHBhcmFtZXRlcnMKX2JpbmRfcGFyYW1zOiAmX2JpbmRfcGFyYW1zCiMgUHJvdmlz\
aW9uIGJpbmQgcGFyYW1zCiAgLSBuYW1lOiBzZXJ2aWNlX25hbWUKICAgIGRpc3BsYXlfZ3JvdXA6\
IFByb3Zpc2lvbgogICAgcmVxdWlyZWQ6IFRydWUKICAgIHRpdGxlOiBOYW1lIG9mIHRoZSBzZXJ2\
aWNlIHRvIGJpbmQKICAgIHR5cGU6IHN0cmluZwogIC0gbmFtZTogcmVkaXJlY3RfdXJpcwogICAg\
ZGlzcGxheV9ncm91cDogUHJvdmlzaW9uCiAgICByZXF1aXJlZDogVHJ1ZQogICAgdGl0bGU6IFJl\
ZGlyZWN0IFVSSXMKICAgIGRlc2NyaXB0aW9uOiBWYWxpZCBSZWRpcmVjdCBVUklzIGEgYnJvd3Nl\
ciBjYW4gcmVkaXJlY3QgdG8gYWZ0ZXIgYSBzdWNjZXNzZnVsIGxvZ2luL2xvZ291dC4gU2ltcGxl\
IHdpbGRjYXJkcyBhcmUgYWxsb3dlZC4gZS5nLiBodHRwczovL215c2VydmljZS1teXByb2plY3Qu\
YXBwcy5leGFtcGxlLmNvbS8qCiAgICB0eXBlOiBzdHJpbmcKICAtIG5hbWU6IHdlYl9vcmlnaW5z\
CiAgICBkaXNwbGF5X2dyb3VwOiBQcm92aXNpb24KICAgIHRpdGxlOiBXZWIgT3JpZ2lucwogICAg\
ZGVzY3JpcHRpb246IFdlYiBPcmlnaW5zIHRvIGFsbG93IENPUlMKICAgIHR5cGU6IHN0cmluZwog\
ICMgQmluZCBzZWNyZXQgcGFyYW1zICh3aGljaCBlbnYgdmFyaWFibGVzIHRvIGNyZWF0ZSkKICAt\
IG5hbWU6IHNzb191cmxfbmFtZQogICAgZGVmYXVsdDogU1NPX1VSTAogICAgZGlzcGxheV9ncm91\
cDogQmluZGluZwogICAgdGl0bGU6IEtleWNsb2FrIFVSTCBWYXJpYWJsZSBuYW1lCiAgICBkZXNj\
cmlwdGlvbjogSG93IHRoZSBhcHBsaWNhdGlvbiB3aWxsIHJlZmVyIHRvIHRoZSBLZXljbG9hayBV\
UkwKICAgIHR5cGU6IHN0cmluZwogIC0gbmFtZTogc3NvX3JlYWxtX25hbWUKICAgIGRlZmF1bHQ6\
IFNTT19SRUFMTQogICAgZGlzcGxheV9ncm91cDogQmluZGluZwogICAgdGl0bGU6IEtleWNsb2Fr\
IFJlYWxtIFZhcmlhYmxlIG5hbWUKICAgIGRlc2NyaXB0aW9uOiBIb3cgdGhlIGFwcGxpY2F0aW9u\
IHdpbGwgcmVmZXIgdG8gdGhlIEtleWNsb2FrIFJlYWxtCiAgICB0eXBlOiBzdHJpbmcKICAtIG5h\
bWU6IHNzb19jbGllbnRfbmFtZQogICAgZGVmYXVsdDogU1NPX0NMSUVOVAogICAgZGlzcGxheV9n\
cm91cDogQmluZGluZwogICAgdGl0bGU6IEtleWNsb2FrIENsaWVudCBWYXJpYWJsZSBuYW1lCiAg\
ICBkZXNjcmlwdGlvbjogSG93IHRoZSBhcHBsaWNhdGlvbiB3aWxsIHJlZmVyIHRvIHRoZSBLZXlj\
bG9hayBDbGllbnQgbmFtZQogICAgdHlwZTogc3RyaW5nCnZlcnNpb246IDEuMQpuYW1lOiBrZXlj\
bG9hay1hcGIKZGVzY3JpcHRpb246IEtleWNsb2FrIC0gT3BlbiBTb3VyY2UgSWRlbnRpdHkgYW5k\
IEFjY2VzcyBNYW5hZ2VtZW50CmJpbmRhYmxlOiBUcnVlCmFzeW5jOiByZXF1aXJlZAp0YWdzOgog\
IC0gc3NvCiAgLSBrZXljbG9hawptZXRhZGF0YToKICBkaXNwbGF5TmFtZTogS2V5Y2xvYWsgKEFQ\
QikKICBjb25zb2xlLm9wZW5zaGlmdC5pby9pY29uQ2xhc3M6IGljb24tc3NvCiAgZG9jdW1lbnRh\
dGlvblVybDogImh0dHA6Ly93d3cua2V5Y2xvYWsub3JnL2RvY3VtZW50YXRpb24uaHRtbCIKICBw\
cm92aWRlckRpc3BsYXlOYW1lOiAiUmVkIEhhdCwgSW5jLiIKICBkZXBlbmRlbmNpZXM6CiAgICAt\
ICdkb2NrZXIuaW8vamJvc3Mva2V5Y2xvYWstb3BlbnNoaWZ0OjMuNC4zLkZpbmFsJwogICAgLSAn\
UG9zdGdyZVNRTCBBUEInCiAgICAtICdNYXJpYURCIEFQQicKICAgIC0gJ015U1FMIEFQQicKICBz\
ZXJ2aWNlTmFtZToga2V5Y2xvYWsKcGxhbnM6CiAgLSBuYW1lOiBsb2NhbAogICAgZGVzY3JpcHRp\
b246IERlcGxveSBrZXljbG9hayBsb2NhbGx5CiAgICBmcmVlOiBUcnVlCiAgICBkZWZhdWx0OiBU\
cnVlCiAgICBtZXRhZGF0YToKICAgICAgZGlzcGxheU5hbWU6IEtleWNsb2FrIChsb2NhbCkKICAg\
IHBhcmFtZXRlcnM6CiAgICAgIC0gbmFtZTogYWRtaW5fdXNlcm5hbWUKICAgICAgICByZXF1aXJl\
ZDogVHJ1ZQogICAgICAgIGRlZmF1bHQ6IGFkbWluCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAg\
ICAgdGl0bGU6IEtleWNsb2FrIGFkbWluIHVzZXJuYW1lCiAgICAgIC0gbmFtZTogYWRtaW5fcGFz\
c3dvcmQKICAgICAgICByZXF1aXJlZDogVHJ1ZQogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAg\
IGRpc3BsYXlfdHlwZTogcGFzc3dvcmQKICAgICAgICB0aXRsZTogS2V5Y2xvYWsgYWRtaW4gcGFz\
c3dvcmQKICAgICAgLSBuYW1lOiBkYl90eXBlCiAgICAgICAgcmVxdWlyZWQ6IFRydWUKICAgICAg\
ICB0aXRsZTogRGF0YWJhc2UgVHlwZQogICAgICAgIGVudW06IFsnRXBoZW1lcmFsJywnUG9zdGdy\
ZVNRTCcsICdNeVNRTCcsICdNYXJpYURCJ10KICAgICAgICB0eXBlOiBlbnVtCiAgICAgICAgZGVm\
YXVsdDogRXBoZW1lcmFsCiAgICAgICAgZGVzY3JpcHRpb246IERhdGFiYXNlIHR5cGUgdG8gY29u\
ZmlndXJlLiBJdCByZXF1aXJlcyB0aGUgZGF0YWJhc2UgQVBCIHRvIGJlIGRlcGxveWVkIGFuZCB0\
aGVuIGJvdW5kIHRvIHRoaXMgYXBwbGljYXRpb24KICAgICAgICB1cGRhdGFibGU6IHRydWUKICAg\
ICAgLSBuYW1lOiBhcGJfa2V5Y2xvYWtfdXJpCiAgICAgICAgcmVxdWlyZWQ6IEZhbHNlCiAgICAg\
ICAgdHlwZTogc3RyaW5nCiAgICAgICAgdGl0bGU6IEtleWNsb2FrIFVSTAogICAgICAgIGRlc2Ny\
aXB0aW9uOiBVUkwgd2hlcmUgdGhlIGFwcGxpY2F0aW9ucyBzaG91bGQgcmVkaXJlY3QgdG8gZm9y\
IGF1dGhlbnRpY2F0aW9uLiBNdXN0IGJlIHJlc29sdmFibGUgYnkgdGhlIGJyb3dzZXIgYW5kIHBv\
ZHMuIExlYXZlIGVtcHR5IHRvIHVzZSB0aGUgaG9zdCBnZW5lcmF0ZWQgYnkgdGhlIHJvdXRlCiAg\
ICBiaW5kX3BhcmFtZXRlcnM6ICpfYmluZF9wYXJhbXMKICAgIHVwZGF0ZXNfdG86CiAgICAgIC0g\
bG9jYWwKICAtIG5hbWU6IGV4dGVybmFsCiAgICBkZXNjcmlwdGlvbjogQWxsb3dzIGF1dGhlbnRp\
Y2F0aW5nIGFwcGxpY2F0aW9ucyB0byBhbiBleHRlcm5hbCBLZXljbG9hayBpbnN0YW5jZQogICAg\
ZnJlZTogVHJ1ZQogICAgbWV0YWRhdGE6CiAgICAgIGRpc3BsYXlOYW1lOiBLZXljbG9hayAoZXh0\
ZXJuYWwpCiAgICBwYXJhbWV0ZXJzOgogICAgICAtIG5hbWU6IGFkbWluX3VzZXJuYW1lCiAgICAg\
ICAgcmVxdWlyZWQ6IFRydWUKICAgICAgICBkZWZhdWx0OiBhZG1pbgogICAgICAgIHR5cGU6IHN0\
cmluZwogICAgICAgIHRpdGxlOiBLZXljbG9hayBhZG1pbiB1c2VybmFtZQogICAgICAtIG5hbWU6\
IGFkbWluX3Bhc3N3b3JkCiAgICAgICAgcmVxdWlyZWQ6IFRydWUKICAgICAgICB0eXBlOiBzdHJp\
bmcKICAgICAgICBkaXNwbGF5X3R5cGU6IHBhc3N3b3JkCiAgICAgICAgdGl0bGU6IEtleWNsb2Fr\
IGFkbWluIHBhc3N3b3JkCiAgICAgIC0gbmFtZTogYXBiX2tleWNsb2FrX3VyaQogICAgICAgIHJl\
cXVpcmVkOiBUcnVlCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgdGl0bGU6IEtleWNsb2Fr\
IFVSTAogICAgICAgIGRlc2NyaXB0aW9uOiBVUkwgd2hlcmUgdGhlIGFwcGxpY2F0aW9ucyBzaG91\
bGQgcmVkaXJlY3QgdG8gZm9yIGF1dGhlbnRpY2F0aW9uLiBNdXN0IGJlIHJlc29sdmFibGUgYnkg\
dGhlIGJyb3dzZXIgYW5kIHBvZHMuCiAgICBiaW5kX3BhcmFtZXRlcnM6ICpfYmluZF9wYXJhbXMK"

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles

RUN chmod -R g=u /opt/{ansible,apb}
USER apb
